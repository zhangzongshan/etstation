"use strict";!function(a){if("function"==typeof require&&"object"==typeof exports&&"object"==typeof module){var b=module.exports||exports;a(b)}else"function"==typeof define&&define.amd?define(["exports"],a):"function"==typeof define&&define.cmd?define(a):a(function(){},window.ImgInput={},{})}(function(a,b,c){function e(a){var b=$('<div class="__inputImgContainerClass"></div>');return""!=a._class&&b.addClass(a._class),b.css({position:"relative","float":"left",margin:a._margin_top+"px "+a._margin_right+"px "+a._margin_bottom+"px "+a._margin_left+"px",height:a._height+"px","line-height":a._height+"px",width:a._containerObj.width()/a._count-(a._margin_left+a._margin_right)+"px","background-size":"contain","background-repeat":"no-repeat","background-position":"center center"}),b}function f(a){return $('<input type="hidden" class="__inputTextClass" name="'+a._name+'"/>')}function g(a){var b=$('<input type="file" class="__inputFileClass" name="'+a._name+'" accept="'+a._accept+'" multiple="multiple"/>');return b.css({position:"absolute",width:"100%",height:"100%",opacity:"0",top:"0px",left:"0px","z-index":10,cursor:"pointer"}),b.change(function(){var b=this.files[0],c=l(b);if(null!=c){var d=$(this).closest(".__inputImgContainerClass");if(d.find("input:hidden").val(""),d.find(".__addItemClass").length>0){d.find(".__addItemClass").remove();var j=a._containerObj.find(".__inputImgContainerClass").length;if(-1===a._total||j<a._total){var k=h(a),m=e(a),n=g(a),o=f(a);m.append(k),m.append(n),m.append(o),d.after(m)}}d.css({"background-image":"url("+c+")"});var p=i(a,d);d.append(p)}}),b}function h(a){var b=$('<div class="__addItemClass"></div>');return b.css({position:"absolute",width:"100%",height:"100%","z-index":5}),""!=a._addItem_text&&b.append($(a._addItem_text)),""!=a._addItem_class&&b.addClass(a._addItem_class),b}function i(a,b){var c=$(a._infoItem_text);return""!=a._infoItem_class&&c.addClass(a._infoItem_class),c.addClass("__imgInfoClass"),c.css({position:"absolute","z-index":10}),k(a._infoItem_item)&&$.each(a._infoItem_item,function(a,d){var e="string"==typeof d.text&&""!==d.text?d.text:"",f="string"==typeof d["class"]&&""!==d["class"]?d["class"]:"",g="function"==typeof d.callback?d.callback:null;if(""!==e){var h=$(e);""!==f&&h.addClass(f),h.off("click"),null!=g&&h.on("click",function(){g(b)}),c.append(h)}}),c}function j(){return $('<div style="clear: both;width: 0px;height: 0px;"></div>')}function k(){return $('<div style="clear: both;width: 0px;height: 0px;"></div>')}function l(a){return a?window[window.webkitURL?"webkitURL":"URL"].createObjectURL(a):null}function o(a,b){return n.init(a,b)}var n={"default":{obj:$("body"),rootpath:"",count:4,margin:{top:5,right:5,bottom:5,left:5},"class":"",name:"imgInput",accept:"image/*",height:70,total:-1,addItem:{text:"<span class='icon-plus'></span>","class":""},infoItem:{text:"<div></div>","class":"",item:[{text:"<span class='icon-home'></span>","class":"",callback:function(a){}},{text:"<span class='icon-trash'></span>","class":"",callback:function(a){}}]},callback:function(){}},init:function(a,b){b="object"==typeof b&&null!=b?b:this["default"];var c="imgInput_"+(new Date).getTime()*Math.floor(1e6*Math.random()),d="string"==typeof b.rootpath&&""!=b.rootpath?b.rootpath:this["default"].rootpath,l="object"==typeof b.obj&&null!=b.obj?b.obj:this["default"].obj,m="number"==typeof b.count&&b.count>0?b.count:this["default"].count,n="object"==typeof b.margin&&null!=b.margin?b.margin:this["default"].margin,o="string"==typeof b["class"]&&""!=b["class"]?b["class"]:this["default"]["class"],p="string"==typeof b.name&&""!=b.name?b.name:this["default"].name,q="string"==typeof b.accept&&""!=b.accept?b.accept:this["default"].accept,r="number"==typeof b.height&&b.height>0?b.height:this["default"].height,s="number"==typeof n.top&&n.top>0?n.top:this.margin.top,t="number"==typeof n.right&&n.right>0?n.right:this.margin.right,u="number"==typeof n.bottom&&n.bottom>0?n.bottom:this.margin.bottom,v="number"==typeof n.left&&n.left>0?n.left:this.margin.left,w="number"==typeof b.total&&b.total>0?b.total:this["default"].total,x="object"==typeof b.addItem&&null!=b.addItem?b.addItem:this["default"].addItem,y=null!=x.text&&""!=x.text?x.text:this["default"].addItem.text,z=null!=x["class"]&&""!=x["class"]?x["class"]:this["default"].addItem["class"],A="object"==typeof b.infoItem&&null!=b.infoItem?b.infoItem:this["default"].infoItem,B=null!=A.text&&""!=A.text?A.text:this["default"].infoItem.text,C=null!=A["class"]&&""!=A["class"]?A["class"]:this["default"].infoItem["class"],D=null!=A.item&&""!=A.item?A.item:this["default"].infoItem.item,E="function"==typeof b.callback&&null!=b.callback?b.callback:this["default"].callback,F={_id:c,_rootpath:d,_containerObj:l,_count:m,_class:o,_name:p,_accept:q,_height:r,_margin_top:s,_margin_right:t,_margin_bottom:u,_margin_left:v,_total:w,_addItem:x,_addItem_text:y,_addItem_class:z,_infoItem_text:B,_infoItem_class:C,_infoItem_item:D,_callback:E},G=e(F),H=g(F),I=f(F),J=j();if(a=k(a)?a:[],a.length>0){if($.each(a,function(a,b){if(""!=b){var c=b,h=e(F),j=g(F),k=f(F);k.val(c),h.css({"background-image":"url("+d+c+")"});var l=i(F,h);h.append(j),h.append(k),h.append(l),F._containerObj.append(h)}}),-1===F._total||a.length<F._total){var L=h(F);G.append(L),G.append(H),G.append(I),F._containerObj.append(G)}}else{var L=h(F);G.append(L),G.append(H),G.append(I),F._containerObj.append(G)}return F._containerObj.append(J),null!=E&&E(),{oConfig:F,obj:F._containerObj,getdata:function(){var a=[];return $.each(this.oConfig._containerObj.find(".__inputImgContainerClass"),function(b,c){var d=$(c).find(".__inputFileClass").val(),e=$(c).find(".__inputTextClass").val();(""!=d||""!=e)&&a.push({file:d,text:e})}),a},redraw:function(){var a=this.oConfig._containerObj.find(".__inputImgContainerClass").length,b=this.oConfig._containerObj.find(".__inputImgContainerClass").last(),c=this.oConfig._containerObj.find(".__addItemClass").length>0?!0:!1;if((-1===this.oConfig._total||a<this.oConfig._total)&&!c){var d=h(this.oConfig),i=e(this.oConfig),k=g(this.oConfig),l=f(this.oConfig);i.append(d),i.append(k),i.append(l),b.length>0?b.after(i):(this.oConfig._containerObj.append(i),this.oConfig._containerObj.append(j()))}}}}};b.Create=function(a,b){return o(a,b)}});